<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paiement - EcoWood</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Work+Sans:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        .checkout-container {
            max-width: 1000px;
            margin: 40px auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            padding: 0 20px;
        }

        .checkout-section {
            background: #fafaf7;
            padding: 30px;
            border-radius: 12px;
        }

        .checkout-section h2 {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--wood-dark);
        }

        .order-summary {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e8e4e0;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #f0ebe7;
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .order-item-name {
            color: var(--wood-dark);
            font-weight: 500;
        }

        .order-item-price {
            color: var(--sage);
            font-weight: 600;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-top: 2px solid #e8e4e0;
            margin-top: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--wood-dark);
        }

        .empty-message {
            background: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            color: #856404;
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--wood-dark);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d4cfc8;
            border-radius: 6px;
            font-family: 'Work Sans', sans-serif;
            font-size: 0.95rem;
            background: white;
            color: var(--wood-dark);
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--sage);
            box-shadow: 0 0 0 3px rgba(139, 146, 121, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .payment-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-method {
            flex: 1;
            padding: 15px;
            border: 2px solid #d4cfc8;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            color: var(--wood-dark);
            transition: all 0.3s;
            background: white;
        }

        .payment-method:hover {
            border-color: var(--sage);
            background: #f9f7f3;
        }

        .payment-method.active {
            border-color: var(--sage);
            background: var(--sage);
            color: white;
        }

        .payment-method input[type="radio"] {
            display: none;
        }

        .card-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: var(--sage);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Work Sans', sans-serif;
        }

        .submit-btn:hover {
            background: #6b7264;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 146, 121, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 15px;
            color: #666;
            font-size: 0.85rem;
        }

        .back-to-shop {
            text-align: center;
            margin-top: 20px;
        }

        .back-to-shop a {
            color: var(--sage);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .back-to-shop a:hover {
            color: var(--wood-dark);
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .checkout-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .payment-methods {
                flex-direction: column;
            }

            .card-fields {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="logo">üåø EcoWood</div>
        <div class="nav-links">
            <a href="index.html">Boutique</a>
            <a href="about.html">√Ä Propos</a>
            <a href="contact.html">Contact</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero hero-small">
        <h1>Paiement S√©curis√©</h1>
        <p>Finalisez votre commande en toute confiance</p>
    </div>

    <!-- Checkout Content -->
    <div class="container">
        <div class="checkout-container">
            <!-- Order Summary -->
            <div class="checkout-section">
                <h2>R√©sum√© de la Commande</h2>
                <div id="orderSummary"></div>
                <div class="back-to-shop">
                    <a href="index.html">‚Üê Continuer les achats</a>
                </div>
            </div>

            <!-- Payment Form -->
            <div class="checkout-section">
                <h2>Informations de Paiement</h2>
                <form id="paymentForm" onsubmit="processPayment(event)">
                    <!-- Personal Info -->
                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: var(--wood-dark); font-size: 1.1rem;">Vos Coordonn√©es</h3>
                    
                    <div class="form-group">
                        <label for="name">Nom complet *</label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">T√©l√©phone *</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>

                    <!-- Delivery Address -->
                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: var(--wood-dark); font-size: 1.1rem;">Adresse de Livraison</h3>
                    
                    <div class="form-group">
                        <label for="address">Adresse *</label>
                        <input type="text" id="address" name="address" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">Ville *</label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div class="form-group">
                            <label for="postal">Code Postal *</label>
                            <input type="text" id="postal" name="postal" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="country">Pays *</label>
                        <select id="country" name="country" required>
                            <option value="">S√©lectionnez un pays</option>
                            <option value="FR">France</option>
                            <option value="BE">Belgique</option>
                            <option value="CH">Suisse</option>
                            <option value="LU">Luxembourg</option>
                            <option value="DE">Allemagne</option>
                            <option value="IT">Italie</option>
                            <option value="ES">Espagne</option>
                            <option value="OTHER">Autre</option>
                        </select>
                    </div>

                    <!-- Payment Method -->
                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: var(--wood-dark); font-size: 1.1rem;">Mode de Paiement</h3>
                    
                    <div class="payment-methods">
                        <label class="payment-method">
                            <input type="radio" name="payment" value="card" checked onchange="togglePaymentFields()">
                            üí≥ Carte
                        </label>
                        <label class="payment-method">
                            <input type="radio" name="payment" value="paypal" onchange="togglePaymentFields()">
                            üÖøÔ∏è PayPal
                        </label>
                        <label class="payment-method">
                            <input type="radio" name="payment" value="transfer" onchange="togglePaymentFields()">
                            üè¶ Virement
                        </label>
                    </div>

                    <!-- Card Payment -->
                    <div id="cardPayment" style="display: block;">
                        <div class="form-group">
                            <label for="cardName">Nom sur la carte *</label>
                            <input type="text" id="cardName" name="cardName" required>
                        </div>

                        <div class="form-group">
                            <label for="cardNumber">Num√©ro de carte *</label>
                            <input type="text" id="cardNumber" name="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19" required>
                        </div>

                        <div class="card-fields">
                            <div class="form-group">
                                <label for="expiry">Expiration (MM/YY) *</label>
                                <input type="text" id="expiry" name="expiry" placeholder="12/25" maxlength="5" required>
                            </div>
                            <div class="form-group">
                                <label for="cvv">CVV *</label>
                                <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4" required>
                            </div>
                        </div>
                    </div>

                    <!-- PayPal Payment -->
                    <div id="paypalPayment" style="display: none;">
                        <div class="form-group">
                            <label for="paypalEmail">Email PayPal *</label>
                            <input type="email" id="paypalEmail" name="paypalEmail">
                        </div>
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Vous serez redirig√© vers PayPal pour finaliser le paiement.</p>
                    </div>

                    <!-- Transfer Payment -->
                    <div id="transferPayment" style="display: none;">
                        <p style="color: #666; font-size: 0.9rem; margin: 10px 0;">Les coordonn√©es bancaires vous seront envoy√©es par email apr√®s confirmation de la commande.</p>
                    </div>

                    <!-- Terms -->
                    <div class="form-group" style="margin-top: 20px;">
                        <input type="checkbox" id="terms" name="terms" required style="width: auto; margin-right: 8px;">
                        <label for="terms" style="display: inline; margin-bottom: 0;">
                            J'accepte les <a href="cgv.html" style="color: var(--sage); text-decoration: none;">conditions g√©n√©rales</a> et <a href="retours.html" style="color: var(--sage); text-decoration: none;">politique de retours</a> *
                        </label>
                    </div>

                    <button type="submit" class="submit-btn">Valider la Commande</button>

                    <div class="security-badge">
                        üîí Paiement 100% S√©curis√©
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>EcoWood</h3>
                <p>Artisanat durable et responsable depuis 2026</p>
            </div>
            <div class="footer-section">
                <h3>Navigation</h3>
                <a href="index.html">Boutique</a>
                <a href="about.html">√Ä Propos</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="footer-section">
                <h3>Contact</h3>
                <a href="mailto:contact@ecowood.fr">contact@ecowood.fr</a>
                <a href="tel:+33123456789">+33 1 23 45 67 89</a>
            </div>
            <div class="footer-section">
                <h3>Informations</h3>
                <a href="livraison.html">Livraison</a>
                <a href="retours.html">Retours</a>
            </div>
            <div class="footer-section">
                <h3>Legal</h3>
                <a href="cgv.html">CGV</a>
                <a href="mentions-legales.html">Mentions legales</a>
                <a href="confidentialite.html">Confidentialite</a>
                <a href="cookies.html">Cookies</a>
            </div>
        </div>
        <div class="copyright">
            ¬© 2026 EcoWood - Tous droits r√©serv√©s
        </div>
    </footer>

    <script>
        // Afficher le r√©sum√© de la commande
        function displayOrderSummary() {
            const summaryDiv = document.getElementById('orderSummary');
            let cart = [];
            
            try {
                // Essayer localStorage d'abord
                let saved = localStorage.getItem('ecowood_cart');
                if (!saved) {
                    // Fallback sur sessionStorage
                    saved = sessionStorage.getItem('ecowood_cart');
                }
                cart = saved ? JSON.parse(saved) : [];
                console.log('Cart loaded from storage:', cart);
            } catch (e) {
                console.error('Error loading cart:', e);
                cart = [];
            }

            if (cart.length === 0) {
                summaryDiv.innerHTML = `
                    <div class="empty-message">
                        Votre panier est vide. <a href="index.html" style="color: #856404; font-weight: 600;">Continuer les achats</a>
                    </div>
                `;
                console.warn('Panier vide - localStorage:', localStorage.getItem('ecowood_cart'), 'sessionStorage:', sessionStorage.getItem('ecowood_cart'));
                return;
            }

            const total = cart.reduce((sum, item) => sum + item.price, 0);
            
            const items = cart.map(item => `
                <div class="order-item">
                    <span class="order-item-name">${item.name}</span>
                    <span class="order-item-price">${item.price.toFixed(2)}‚Ç¨</span>
                </div>
            `).join('');

            summaryDiv.innerHTML = `
                <div class="order-summary">
                    ${items}
                    <div class="order-total">
                        <span>Total</span>
                        <span>${total.toFixed(2)}‚Ç¨</span>
                    </div>
                </div>
                <p style="color: #666; font-size: 0.9rem; margin-top: 15px;">
                    ‚úì Livraison gratuite en France m√©tropolitaine
                </p>
            `;
        }

        // Basculer entre les champs de paiement
        function togglePaymentFields() {
            const cardPayment = document.getElementById('cardPayment');
            const paypalPayment = document.getElementById('paypalPayment');
            const transferPayment = document.getElementById('transferPayment');
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;

            cardPayment.style.display = paymentMethod === 'card' ? 'block' : 'none';
            paypalPayment.style.display = paymentMethod === 'paypal' ? 'block' : 'none';
            transferPayment.style.display = paymentMethod === 'transfer' ? 'block' : 'none';

            // Mettre √† jour les required
            if (paymentMethod === 'card') {
                document.getElementById('cardName').required = true;
                document.getElementById('cardNumber').required = true;
                document.getElementById('expiry').required = true;
                document.getElementById('cvv').required = true;
                document.getElementById('paypalEmail').required = false;
            } else if (paymentMethod === 'paypal') {
                document.getElementById('cardName').required = false;
                document.getElementById('cardNumber').required = false;
                document.getElementById('expiry').required = false;
                document.getElementById('cvv').required = false;
                document.getElementById('paypalEmail').required = true;
            } else {
                document.getElementById('cardName').required = false;
                document.getElementById('cardNumber').required = false;
                document.getElementById('expiry').required = false;
                document.getElementById('cvv').required = false;
                document.getElementById('paypalEmail').required = false;
            }
        }

        // Formater le num√©ro de carte
        document.getElementById('cardNumber')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s+/g, '');
            let formattedValue = value.replace(/(\d{4})/g, '$1 ').trim();
            e.target.value = formattedValue;
        });

        // Formater la date d'expiration
        document.getElementById('expiry')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.slice(0, 2) + '/' + value.slice(2, 4);
            }
            e.target.value = value;
        });

        // Traiter le paiement
        function processPayment(event) {
            event.preventDefault();
            
            let cart = [];
            try {
                let saved = localStorage.getItem('ecowood_cart');
                if (!saved) {
                    saved = sessionStorage.getItem('ecowood_cart');
                }
                cart = saved ? JSON.parse(saved) : [];
            } catch (e) {
                console.error('Error loading cart:', e);
            }
            
            if (cart.length === 0) {
                alert('Votre panier est vide!');
                return;
            }

            const total = cart.reduce((sum, item) => sum + item.price, 0);
            const name = document.getElementById('name').value;
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;

            // Simuler le traitement du paiement
            const btn = event.target.querySelector('.submit-btn');
            btn.disabled = true;
            btn.textContent = 'Traitement en cours...';

            setTimeout(() => {
                // Message de confirmation
                alert(`‚úì Paiement r√©ussi!\n\n${name}, votre commande a √©t√© confirm√©e.\nMontant: ${total.toFixed(2)}‚Ç¨\nMode de paiement: ${paymentMethod}\n\nUn email de confirmation a √©t√© envoy√© √† ${document.getElementById('email').value}\n\nMerci pour votre achat chez EcoWood! üåø`);

                // Vider le panier
                try {
                    localStorage.removeItem('ecowood_cart');
                } catch (e) {}
                try {
                    sessionStorage.removeItem('ecowood_cart');
                } catch (e) {}
                
                // Rediriger vers la boutique
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1000);
            }, 1500);
        }

        // Afficher le r√©sum√© au chargement
        document.addEventListener('DOMContentLoaded', function() {
            displayOrderSummary();
            
            // Gestion des m√©thodes de paiement
            document.querySelectorAll('input[name="payment"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const label = this.parentElement;
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
                    label.classList.add('active');
                });
            });

            // Marquer la premi√®re m√©thode comme active
            document.querySelector('.payment-method').classList.add('active');
        });
    </script>
</body>
</html>
